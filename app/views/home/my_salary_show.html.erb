<div class="row">
  <div class="large-12 small-12 columns">
    <h1><%= t :my_salary %></h1>
  </div>
  <hr>
</div>

<div class="row">
  <div class="large-12 columns">
    <table class="large-8">
      <thead>
         <tr>
          <th colspan="2"><center><%= t :payments %></center></th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td><%= t :date %></td>
          <td><%= @payslip.date.to_date.strftime("%d/%m/%Y") %></td>
        </tr>
      </tbody>

      <thead>
        <tr>
          <th><%= t :description %></th>
          <th><%= t :amount %></th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td><%= t :base_salary %></td>
          <td><%= humanized_money_with_symbol @payslip.base_salary %></td>
        </tr>
        <tr>
          <td><%= t :commission %></td>
          <td><%= humanized_money_with_symbol @payslip.commission %></td>
        </tr>
        <tr>
          <th><%= t :total_payment %></th>
          <td><%= humanized_money_with_symbol @payslip.commission+@payslip.base_salary %></td>
        </tr>
      </tbody>

      <thead>
        <th colspan="2"><center><%= t :claims %></center></th>
      </thead>

      <tbody>
        <% current_account.profile.claims.where(status: "Approved", date: @payslip.date.beginning_of_month..@payslip.date.end_of_month).each do |claim|%>
          <tr>
            <td><%= claim.subject %></td>
            <td>
            <%= humanized_money_with_symbol claim.amount %>
            <%#= humanized_money_with_symbol (current_account.profile.claims.where(status: "Approved", date: @payslip.date.beginning_of_month..@payslip.date.end_of_month).sum :amount_cents)/100 %></td>
          </tr>
        <% end %>
      </tbody>

      <%total = @payslip.base_salary_cents + @payslip.commission_cents.to_i + (current_account.profile.claims.where(status: "Approved", date: @payslip.date.beginning_of_month..@payslip.date.end_of_month).sum :amount_cents) %>
      <thead>
        <th colspan="2"><center><%= t :others %></center></th>
      </thead>

      <tbody>
        <% @payslip.payslip_settings.each do |payslip_setting| %>
          <% if payslip_setting.positive? %>
            <tr>
              <td><%=payslip_setting.name%></td>
              <td><%=humanized_money_with_symbol @payslip.calculate(payslip_setting)/100%></td>
            </tr>
          <% else %>
            <tr>
              <td><%=payslip_setting.name%></td>
              <td><%=humanized_money_with_symbol @payslip.calculate(payslip_setting)/100%></td>
            </tr>
          <% end %>
          <%total = total + @payslip.calculate(payslip_setting)%>     
        <% end %>
      </tbody>
    </table>

    <table class="large-8">
      <thead>
         <tr>
            <th><%= t :net_pay %></th>
            <th><%= humanized_money_with_symbol total/100 %></th>
          </tr>
      </thead>
    </table>
    <%= link_to t(:back), :back, class: "button success" %>
  </div>
</div>